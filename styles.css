/*
        * ===================================
        * üíø CSS STYLESHEET (FINAL OPTIMIZED VERSION - With Collection View Update)
        * ===================================
        */

        /* üí° CRITICAL FIX: Global Box Model Setup */
        *,
        *::before,
        *::after {
          /* Ensures padding and border are included in the element's width/height */
          box-sizing: border-box;
        }


        /* ===== Global Styles & Variables ===== */
        :root {
        /* Light Mode Defaults */
        --bg-primary: #faf7f2; /* Light Cream */
        --text-primary: #222; /* Dark Text */
        --text-secondary: #666; /* Muted Text */
        --card-bg: #fff;
        --card-border: #222;
        --accent-color: #ff4081; /* Pink */
        --star-color: #ffd700;
        }

        body {
        margin: 0;
        font-family: 'Inter', sans-serif;
        background: var(--bg-primary); 
        color: var(--text-primary); 
        transition: background-color 0.3s, color 0.3s;
        }

        h1, h2, h3 {
        margin: 0;
        font-weight: 700;
        }

        /* ===== Header & Footer ===== */
        .site-header, .site-footer {
        background-color: #222;
        color: #eee;
        padding: 1rem 0;
        }

        .container {
        width: 90%;
        max-width: 1100px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        }

        .logo {
        font-family: 'Arial Black', Arial, sans-serif;
        font-size: 1.8rem;
        margin: 0;
        }

        .main-nav ul {
        list-style: none;
        display: flex;
        gap: 1.5rem;
        margin: 0;
        padding: 0;
        }

        .main-nav a {
        color: #eee;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.3s ease;
        }

        .main-nav a:hover,
        .main-nav a:focus {
        color: var(--accent-color);
        outline: none;
        }

        .site-footer p {
        margin: 0;
        }

        .social-links a {
        color: #eee;
        margin-left: 1rem;
        font-size: 1.2rem;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        transition: color 0.3s ease;
        }

        .social-links a:hover,
        .social-links a:focus {
        color: var(--accent-color); 
        outline: none;
        }

        /* --- Dark Mode Toggle Button (INVERTED STYLE) --- */
        #darkModeToggle {
            /* üü¢ Light Mode: Dark background, light text/icon for high contrast */
            background-color: #222; 
            border: 2px solid #222; 
            color: #eee;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #darkModeToggle:hover {
            /* Hover effect uses the accent color */
            background-color: #444; 
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* ===== Stats Section ===== */
        .stats-section {
        padding: 2rem 1rem;
        max-width: 900px;
        margin: auto;
        }

        .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.8rem;
        padding: 1rem;
        max-width: 1100px;
        margin: 0 auto 3rem;
        }

        .stat-card {
        color: var(--text-primary); 
        background: var(--card-bg); 
        padding: 1.3rem 1.6rem;
        border-radius: 12px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); 
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        transition: transform 0.3s ease;
        }

        .stat-card:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); 
        }

        .stat-card h2, 
        .stat-card h3 { 
        font-size: 1.2rem;
        margin-bottom: 0.8rem;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        font-weight: 700;
        border-bottom: 2px solid var(--text-primary);
        padding-bottom: 0.3rem;
        width: 100%;
        }
        .stat-card h2 { 
        font-size: 1.4rem;
        width: 80%;
        margin: 0 0 1rem 0;
        padding-bottom: 0.5rem;
        }


        .stat-card p,
        .stat-card ul {
        font-size: 1rem;
        line-height: 1.4;
        margin: 0;
        max-width: 90%;
        }

        .stat-card ul {
        list-style: none;
        padding-left: 0;
        }

        .stat-card ul li {
        margin-bottom: 0.4rem;
        border-bottom: 1px dotted var(--text-primary);
        padding-bottom: 0.2rem;
        }

        /* Random Album Styling */
        .random-album-container {
        text-align: center;
        margin-top: .5rem;
        display: flex;
        flex-direction: column; 
        align-items: center;
        color: var(--text-primary); 
        }

        .random-album-img {
        width: 150px;
        height: 150px;
        position: relative; 
        z-index: 1;
        object-fit: cover; 
        border-radius: 10px;
        box-shadow: 0 5px 12px rgba(0,0,0,0.6);
        display: block;
        margin: 0.5rem auto 1.5rem auto;
        transition: transform 0.3s ease;
        }

        .stat-card:hover .random-album-img {
        transform: scale(1.08);
        z-index: 5; 
        }

        .random-album-text {
        text-align: center;
        margin-top: 1.2rem; 
        position: relative;
        z-index: 10;
        }

        #randomAlbumText {
        margin-top: 1.2rem !important; 
        }

        .random-pick-btn {
        margin-top: 0.6rem;
        padding: 6px 12px;
        background: #444;
        color: #eee;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        margin-top: 1.5rem;
        padding: 6px 12px;
        }

        .random-pick-btn:hover {
        background: #666;
        }


        /* ===== Collection Controls & Filters ===== */
        .collection-controls {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        align-items: center;
        justify-content: space-between;
        padding: 0 1rem;
        max-width: 1100px;
        margin: 1.5rem auto;
        }

        .controls-left, .controls-right {
        display: flex;
        gap: 1rem;
        align-items: center;
        }

        #searchBar {
        flex-grow: 1;
        padding: 10px 15px;
        border: 2px solid var(--text-primary);
        border-radius: 8px;
        font-size: 1rem;
        max-width: 60%;
        outline: none;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        }

        #sortDropdown {
        padding: 10px 15px;
        border: 2px solid var(--text-primary);
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        outline: none;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        }

        /* Genre Filter Buttons */
        .genre-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0 auto 2rem;
        padding: 0 1rem;
        max-width: 1100px;
        }

        .genre-filter-btn {
        background: #eee;
        color: #222;
        border: 1px solid #ccc;
        padding: 6px 12px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s ease;
        }

        .genre-filter-btn:hover {
        background-color: #ddd;
        border-color: #222;
        }

        .genre-filter-btn.active {
        background-color: #222;
        color: #f0e6d2;
        border-color: #222;
        font-weight: 600;
        }

        /* Favorites Filter Button specific styles (LIGHT MODE) */
        #favoritesFilterBtn {
        background: #f0e6d2;
        color: var(--text-primary);
        }

        #favoritesFilterBtn.active {
        background-color: var(--accent-color);
        color: white;
        border-color: var(--accent-color);
        }


        /* ===== Album Gallery & Cards ===== */
        .album-gallery {
        /* Updated padding to match new grid structure */
        padding: 2rem 1.5rem 4rem; 
        max-width: 1100px;
        margin: auto;
        }

        /* üü¢ UPDATE: Fixed 5-column grid layout */
        .album-grid {
            display: grid;
            /* Fixed 5 columns for the visual style requested */
            grid-template-columns: repeat(5, 1fr); 
            /* Use gap for clean spacing between cards */
            gap: 20px; 
            margin-top: 1.5rem;
            /* Reset old margin/padding system */
            margin-left: 0; 
            margin-right: 0; 
            padding: 0; 
        }
        
        /* Added for Responsiveness */
        @media (max-width: 1200px) {
            .album-grid {
                grid-template-columns: repeat(4, 1fr); 
            }
        }
        @media (max-width: 800px) {
            .album-grid {
                grid-template-columns: repeat(3, 1fr); 
            }
        }


        /* üü¢ UPDATE: Card appearance to match the dark, borderless style in the image */
        .album-card {
            background-color: #1a1a1a; /* Very dark gray/black background for the card */
            color: #eee;
            border: none; /* Remove border */
            border-radius: 6px; /* Slightly tighter radius */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4); /* Subtle shadow for depth */

            overflow: hidden;
            transition: transform 0.15s ease;

            padding: 10px; /* Uniform padding inside the card */
            text-align: center;
            position: relative; 
            display: flex;
            flex-direction: column;
            height: 100%;
            margin: 0; /* Margin handled by grid gap */
        }

        .album-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.6); /* Slightly stronger shadow on hover */
        }

        .album-cover {
        width: 100%;
        aspect-ratio: 1/1;
        object-fit: cover;
        display: block;
        border-radius: 6px;
        border: 1px solid #333; /* Darker border for the cover image itself */
        }

        /* üÜï FIX: Alignment Group */
        .album-info-group {
         /* Pushes card controls to the bottom consistently */
         margin-bottom: auto; 
        }

        .album-title {
        /* üõë FIX: Adding a clear margin top for spacing under the cover */
        margin-top: 0.5rem; 
        font-size: 1rem;
        color: white; /* Ensure title is white */
        font-weight: 600;
        }

        .album-artist {
        color: #aaa; /* Lighter secondary text color */
        font-size: .9rem;
        margin-top: 2px;
        margin-bottom: 0.5rem; 
        }
        
        /* üõë REMOVED: .card-bottom-controls is no longer needed as buttons are stacked vertically */
        .card-bottom-controls {
            /* Changed to column flow to contain the play/fav controls */
            width: 100%;
            padding-top: 0.5rem;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
        }

        /* --- Listen Button Styles (Updated for Full Width) --- */
        .album-link.vinyl {
            /* üü¢ UPDATE: Full width button like the target image */
            width: 100%; 
            background-color: #387c9c; /* Distinct Listen color */
            color: white; 
            padding: 0.5rem 0; /* Adjust vertical padding */
            border-radius: 4px; 
            font-weight: 600;
            display: flex; 
            align-items: center;
            justify-content: center; /* Center content */
            gap: 0.6rem;
            text-decoration: none;
            box-shadow: none;
            transition: background-color 0.3s ease;
            margin-top: 10px; 
            margin-bottom: 0; 
            align-self: unset; 
        }

        .album-link.vinyl:hover {
            background-color: #4a91b5; /* Slightly lighter hover color */
            box-shadow: none;
        }

        .album-link.vinyl i {
        font-size: 1.2rem;
        }

        @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
        }

        .album-link.vinyl i:hover {
        animation: spin 1.5s linear infinite;
        }

        /* ===== Notes Button & Section (Updated for Small, Centered Button) ===== */
        .notes-btn {
            /* üü¢ UPDATE: Small, centered button like the target image */
            position: relative; 
            background: #333; /* Darker gray background */
            color: #eee;
            border: none;
            padding: 4px 10px; 
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem; 
            transition: background-color 0.3s;
            z-index: 1; 
            display: inline-block; /* Allows it to be centered */
            width: auto; 
            text-align: center; 
            /* Center it horizontally and add space below */
            margin: 8px auto 8px auto; 
        } 

        .notes-btn:hover {
        background-color: #555;
        }

        .notes-section {
        margin-top: 0.8rem;
        display: none;
        flex-direction: column;
        position: absolute; 
        bottom: 0;
        left: 0;
        right: 0;
        background: #fdfdfd;
        border-top: 1px solid #ccc;
        padding: 1rem 0.8rem 0.5rem;
        border-radius: 0 0 10px 10px;
        box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
        z-index: 30;
        }

        .notes-section.active {
        display: flex;
        }

        .notes-textarea {
        width: 100%;
        min-height: 60px;
        resize: vertical;
        border-radius: 6px;
        border: 1px solid #ccc;
        padding: 6px;
        font-family: inherit;
        font-size: 0.9rem;
        }

        .notes-save-btn {
        margin-top: 6px;
        align-self: flex-end;
        padding: 5px 10px;
        background-color: #4caf50;
        border: none;
        color: white;
        border-radius: 5px;
        cursor: pointer;
        }

        .notes-save-btn:hover {
        background-color: #43a047;
        }

        .notes-confirmation {
        font-size: 0.8rem;
        color: #4caf50;
        margin-top: 4px;
        opacity: 0;
        transition: opacity 0.5s ease;
        }

        .notes-confirmation.visible {
        opacity: 1;
        }

        /* =================================== */
        /* ‚≠ê Rating, Play Count, Favorites */
        /* =================================== */

        .rating-play-controls {
            /* üü¢ NEW: Container for play count and heart icon, centered */
            display: flex;
            justify-content: space-around; /* Distribute items */
            align-items: center; 
            margin-top: 0.6rem;
            margin-bottom: 0.4rem;
            width: 100%;
            padding: 0 5px; 
        }

        /* üõë NEW: Hide the rating stars group */
        .rating-display-group {
        display: none; 
        }

        /* ‚ù§Ô∏è Favorites Icon (Now inside .rating-play-controls) */
        .favorite-icon {
        font-size: 1.3rem; 
        cursor: pointer;
        transition: color 0.2s ease, transform 0.2s ease;
        color: #ccc; 
        margin: 0; 
        }

        /* Style for favorited albums (fa-solid) */
        .fa-solid.fa-heart {
        color: var(--accent-color);
        text-shadow: 0 0 5px rgba(255, 64, 129, 0.6);
        }

        .favorite-icon:hover {
        transform: scale(1.15);
        }

        /* üéß Play Count Display */
        .play-count {
        font-size: 0.85rem;
        color: var(--text-secondary);
        margin: 0;
        display: inline-flex; 
        align-items: center; 
        gap: 4px; 
        }

        /* =================================== */
        /* üÜï Volume Control Cleanup */
        /* =================================== */

        .volume-control {
          width: 100%;
          display: flex; /* Use Flexbox to align label and input */
          align-items: center;
          justify-content: space-between;
          margin-top: 0.5rem; 
          padding: 0 0 0.5rem 0; /* Add a little bottom padding */
        }

        .volume-control label {
          font-size: 0.8rem;
          color: var(--text-secondary);
        }

        .volume-knob {
          flex-grow: 1; /* Allows the slider to take up available space */
          margin: 0 0.5rem;
        }


        /* =================================== */
        /* üåô DARK MODE OVERRIDES */
        /* =================================== */

        body.dark-mode {
        --bg-primary: #121212; 
        --text-primary: #f0e6d2; 
        --text-secondary: #aaa;
        --card-bg: #1e1e1e; 
        --card-border: #555;
        }

        /* Controls and Inputs */
        body.dark-mode #searchBar,
        body.dark-mode #sortDropdown {
        background-color: #333;
        color: var(--text-primary);
        border-color: #666;
        }

        /* Dark Mode Toggle Button: FIXED */
        body.dark-mode #darkModeToggle {
            /* Dark Mode: Transparent background, light text/icon */
            background-color: transparent; 
            color: #eee; 
            border-color: #eee; 
        }

        body.dark-mode #darkModeToggle:hover {
            background-color: #333; 
            border-color: var(--accent-color);
            color: var(--accent-color);
        }


        /* üü¢ UPDATE: Dark Mode Album Cards to maintain the dark look */
        body.dark-mode .album-card {
            background-color: #1a1a1a; /* Enforce the specific dark color */
            border: none;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6); 
        }

        body.dark-mode .album-card:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.8);
        }

        body.dark-mode .album-cover {
            border-color: #333;
        }

        body.dark-mode .album-title {
        color: white; /* Ensure it stays bright */
        }

        body.dark-mode .album-artist {
        color: #aaa;
        }

        body.dark-mode .play-count {
        color: var(--text-secondary);
        }

        /* Notes Section */
        body.dark-mode .notes-section {
        background: #252525;
        border-top: 1px solid #555;
        }

        body.dark-mode .notes-textarea {
        background: #333;
        /* Text color set to pure white for high contrast */
        color: white; 
        border-color: #555;
        }

        body.dark-mode .notes-btn {
            background: #555;
        }

        body.dark-mode .notes-btn:hover {
            background: #777;
        }

        /* Stats Cards */
        body.dark-mode .stat-card {
        background: var(--card-bg); 
        color: var(--text-primary);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .stat-card:hover {
        box-shadow: 0 10px 25px rgba(240, 230, 210, 0.1); 
        }

        body.dark-mode .stat-card h2, 
        body.dark-mode .stat-card h3 { 
        border-bottom: 2px solid #555; 
        }

        body.dark-mode .stat-card ul li {
        border-bottom: 1px dotted #555;
        }

        /* Filter Buttons */
        body.dark-mode .genre-filter-btn {
        background: #333;
        color: var(--text-primary);
        border: 1px solid #555;
        }

        body.dark-mode .genre-filter-btn:hover {
        background-color: #444;
        }

        body.dark-mode .genre-filter-btn.active {
        background-color: var(--text-primary); 
        color: #222;
        border-color: var(--text-primary);
        }

        /* Favorites Filter Button */
        body.dark-mode #favoritesFilterBtn {
        background: #333; 
        color: var(--text-primary); 
        }

        body.dark-mode #favoritesFilterBtn.active {
        background-color: var(--accent-color);
        color: #121212;
        border-color: var(--accent-color);
        }